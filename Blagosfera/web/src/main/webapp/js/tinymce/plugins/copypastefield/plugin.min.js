copiedFieldNode = null;
tinymce.PluginManager.add("copypastefield", function (editor) {
    editor.addMenuItem("copyfield", {
        text: "Скопировать поле",
        icon: false,
        tooltip : "Скопировать поле",
        //disabled : true,
        onclick: function(e) {
            var selectedNode = editor.selection.getNode();
            if (selectedNode.nodeName.toLowerCase() == 'span' && $(selectedNode).hasClass("mceNonEditable")) {
                copiedFieldNode = selectedNode.cloneNode(true);
                //alert("Поле скопировано!");
            } else {
                alert("Выбранный элемент не является полем!");
            }
        }
    });
    editor.addMenuItem("pastefield", {
        text: "Вставить поле",
        icon: false,
        tooltip : "Вставить поле",
        //disabled : true,
        onclick: function(e) {
            //var range = editor.selection.getRng();
            if (copiedFieldNode != null) {
                $(copiedFieldNode).attr("data-span-id", Math.round(new Date().getTime() + (Math.random() * 100)));
                var rawHtmlNode = copiedFieldNode.outerHTML + "&nbsp;";
                editor.selection.setContent(rawHtmlNode);

                //copiedFieldNode = copiedFieldNode.cloneNode(true);
                editor.focus();
            } else {
                alert("Необходимо сначало скопировать поле!");
            }
        }
    });
});